function convert(c,b){switch(b){case"int":var a=c.split(".");c=parseInt(a[0])+parseInt(a[1])+parseInt(a[2])+parseInt(a[3]);return parseInt(c);break;default:return c.toString()}}function compareCols(b,a){return function c(d,f){value1=convert(d.cells[b].innerHTML,a);value2=convert(f.cells[b].innerHTML,a);if(value1<value2){return -1}else{if(value1>value2){return 1}else{return 0}}}}function sortTable(g,b,j,l){if(enable_block_device==1||l==1){var k=document.getElementById(g);var f=k.tBodies[0];var h=f.rows;var c=new Array();for(var d=0;d<h.length;d++){c[d]=h[d]}if(f.sortCol==b){c.reverse()}else{c.sort(compareCols(b,j))}var a=document.createDocumentFragment();for(var d=0;d<c.length;d++){if(d%2==1){c[d].className="even_line"}else{c[d].className="odd_line"}a.appendChild(c[d])}f.appendChild(a);f.sortCol=b}}function load_sortTable(l,n,b,p,t){var f=0;var d=0;var c=0;if(enable_block_device==1||t==1){var s=document.getElementById(l);var h=s.tBodies[0];var o=h.rows;var r=new Array();var q=new Array();for(var g=0;g<o.length;g++){if(o[g].cells[n].innerHTML.indexOf("Blocked")>-1){r[f]=o[g];f++}}for(var g=0;g<o.length;g++){if(o[g].cells[n].innerHTML.indexOf("Allowed")>-1){q[d]=o[g];d++}}r.sort(compareCols(b,p));q.sort(compareCols(b,p));var a=document.createDocumentFragment();for(var g=0;g<r.length;g++){if(g%2==1){r[g].className="even_line"}else{r[g].className="odd_line"}a.appendChild(r[g])}c=g;for(var g=0;g<q.length;g++){if(c%2==1){q[g].className="even_line"}else{q[g].className="odd_line"}a.appendChild(q[g]);c++}h.appendChild(a);h.sortCol=b}}function access_cancel(){location.href="AccessControl_show.htm"}function check_all_device(this_e,start,id){var cf=document.forms[0];var i=start;var e;var type=this_e.checked;if(id=="checkbox_index"){for(i=1;i<=access_control_device_num;i++){if(e=eval('document.getElementById("'+id+i+'")')){e.checked=type}}}else{while(e=eval('document.getElementById("'+id+i+'")')){e.checked=type;i++}}if(id=="checkbox_index"){toggle_edit()}else{if(id=="checkbox_index_white"){toggle_edit_allow()}else{if(id=="checkbox_index_black"){toggle_edit_block()}}}}function set_allow_block(cf,flag){access_control_apply(cf,"0");if(flag==1){cf.submit_flag.value="acc_control_allow"}else{cf.submit_flag.value="acc_control_block"}var sel_num=0;var sel_list="";if(access_control_device_num>0){for(i=1;i<=access_control_device_num;i++){var listName="checkbox_index"+i;if(e=eval("document.getElementById(listName)")){if(document.getElementById(listName).checked==true){if(flag==0&&document.getElementById(listName).value.toLowerCase()==wan_remote_mac.toLowerCase()){alert("$not_block_device_msg");return false}sel_list+=document.getElementById(listName).value;sel_list+="#";sel_num++}}}if(sel_num==0){return false}if(flag==0&&sel_num!=0&&confirm("$acc_block_check")==false){return false}cf.hidden_change_list.value=sel_list;cf.hidden_change_num.value=sel_num;cf.action="/apply.cgi?/access_control_plsWait.htm timestamp="+ts;cf.submit()}else{return false}}function check_edit(){var count=0;var select_num;var cf=document.forms[0];if(access_control_device_num==0){alert("$port_edit");return false}for(i=1;i<=access_control_device_num;i++){var listName="checkbox_index"+i;if(e=eval("document.getElementById(listName)")){if(document.getElementById(listName).checked==true){select_num=i+1;count++}}}if(count==0||count!=1){alert("$port_edit");return false}else{access_control_apply(cf,"0");cf.select_edit.value=select_num-1;cf.submit_flag.value="editnum_connect_device";cf.action="/apply.cgi?/edit_connect_device.htm timestamp="+ts;cf.submit();return true}}function delete_block(){var c=document.forms[0];access_control_apply(c,"0");c.submit_flag.value="delete_acc";var d="";var b=0;if(blocked_no_connect_num>0){for(i=1;i<=blocked_no_connect_num;i++){var a="checkbox_index_black"+i;if(document.getElementById(a).checked==true){d+=document.getElementById(a).value;d+="#";b++}}if(d==""){return false}if(confirm("$acc_del_check")==false){return false}c.hidden_del_list.value=d;c.hidden_del_num.value=b;c.submit()}else{return false}}function delete_allow(){var c=document.forms[0];access_control_apply(c,"0");c.submit_flag.value="delete_acc";var d="";var b=0;if(allowed_no_connect_num>0){for(i=1;i<=allowed_no_connect_num;i++){var a="checkbox_index_white"+i;if(document.getElementById(a).checked==true){d+=document.getElementById(a).value;d+="#";b++}}if(d==""){return false}if(confirm("$acc_del_check")==false){return false}c.hidden_del_list.value=d;c.hidden_del_num.value=b;c.submit()}else{return false}}function access_control_apply(b,a){if(b.enable_acl.checked==false){b.hid_able_block_device.value=0}else{b.hid_able_block_device.value=1}if(b.access_all[0].checked==false){b.hid_new_device_status.value="Block"}else{b.hid_new_device_status.value="Allow"}b.submit_flag.value="apply_acc_control";if(a=="1"){b.submit()}}function check_status(){var cf=document.forms[0];var flag;flag=(!(cf.enable_acl.checked));setDisabled(flag,cf.access_all[0],cf.access_all[1],cf.Allow,cf.Block,cf.checkbox_index);setDisabled(flag,document.getElementById("delete_white"),document.getElementById("delete_black"),cf.checkbox_index_white,cf.checkbox_index_black,document.getElementById("add_black"),document.getElementById("add_white"));if(cf.enable_acl.checked==false){setDisabled(true,cf.edit_attached,cf.edit_white,cf.edit_black);enable_block_device=0;cf.Allow.className="common_gray_bt";cf.Block.className="common_gray_bt";cf.edit_attached.className="common_gray_bt";for(i=1;i<=access_control_device_num;i++){if(e=eval('document.getElementById("checkbox_index"+i)')){e.disabled=true}}document.getElementById("delete_white").className="long_common_gray_bt";document.getElementById("add_white").className="common_gray_bt";cf.edit_white.className="common_gray_bt";for(i=1;i<=allowed_no_connect_num;i++){document.getElementById("checkbox_index_white"+i).disabled=true}document.getElementById("delete_black").className="long_common_gray_bt";document.getElementById("add_black").className="common_gray_bt";cf.edit_black.className="common_gray_bt";for(i=1;i<=blocked_no_connect_num;i++){document.getElementById("checkbox_index_black"+i).disabled=true}}else{toggle_edit();toggle_edit_allow();toggle_edit_block();enable_block_device=1;cf.Allow.className="common_bt";cf.Block.className="common_bt";for(i=1;i<=access_control_device_num;i++){if(e=eval('document.getElementById("checkbox_index"+i)')){e.disabled=false}}document.getElementById("delete_white").className="common_big_bt";document.getElementById("add_white").className="common_bt";for(i=1;i<=allowed_no_connect_num;i++){document.getElementById("checkbox_index_white"+i).disabled=false}document.getElementById("delete_black").className="common_big_bt";document.getElementById("add_black").className="common_bt";for(i=1;i<=blocked_no_connect_num;i++){document.getElementById("checkbox_index_black"+i).disabled=false}}}function check_acc_add(cf,flag){if(cf.mac_addr.value.length==12&&cf.mac_addr.value.indexOf(":")==-1){var mac=cf.mac_addr.value;cf.mac_addr.value=mac.substr(0,2)+":"+mac.substr(2,2)+":"+mac.substr(4,2)+":"+mac.substr(6,2)+":"+mac.substr(8,2)+":"+mac.substr(10,2)}else{if(cf.mac_addr.value.split("-").length==6){var tmp_mac=cf.mac_addr.value.replace(/-/g,":");cf.mac_addr.value=tmp_mac}}if(maccheck(cf.mac_addr.value)==false){return false}if(flag!="edit_allow"&&flag!="edit_block"&&flag!="edit_connect_device"){for(i=0;i<acc_mac_num;i++){var str=eval("acc_mac"+i);if(str.toLowerCase()==cf.mac_addr.value.toLowerCase()){alert("$mac_dup");return false}}}if(flag=="edit_allow"){for(i=0;i<allowed_no_connect_num;i++){var str=eval("allowed_no_connect"+i);var each_info=str.split(" ");if(select_editnum!=i){if(each_info[1].toLowerCase()==cf.mac_addr.value.toLowerCase()){alert("$mac_dup");return false}}}for(i=0;i<blocked_no_connect_num;i++){var str=eval("blocked_no_connect"+i);var each_info=str.split(" ");if(each_info[1].toLowerCase()==cf.mac_addr.value.toLowerCase()){alert("$mac_dup");return false}}for(i=0;i<access_control_device_num;i++){var str=eval("access_control_device"+i);var each_info=str.split("*");if(each_info[2].toLowerCase()==cf.mac_addr.value.toLowerCase()){alert("$mac_dup");return false}}if(cf.allow_or_block.value=="Blocked"){cf.hidden_acc_edit_type.value="block"}}if(flag=="edit_block"){for(i=0;i<blocked_no_connect_num;i++){var str=eval("blocked_no_connect"+i);var each_info=str.split(" ");if(select_editnum!=i){if(each_info[1].toLowerCase()==cf.mac_addr.value.toLowerCase()){alert("$mac_dup");return false}}}for(i=0;i<allowed_no_connect_num;i++){var str=eval("allowed_no_connect"+i);var each_info=str.split(" ");if(each_info[1].toLowerCase()==cf.mac_addr.value.toLowerCase()){alert("$mac_dup");return false}}for(i=0;i<access_control_device_num;i++){var str=eval("access_control_device"+i);var each_info=str.split("*");if(each_info[2].toLowerCase()==cf.mac_addr.value.toLowerCase()){alert("$mac_dup");return false}}if(cf.allow_or_block.value=="Allowed"){cf.hidden_acc_edit_type.value="allow"}}if(flag=="edit_connect_device"){if(access_mac.toLowerCase()==cf.hidden_edit_mac.value.toLowerCase()){var str=document.getElementById("allow_or_block_connect_device");if(str.options[1].selected==true){alert("$not_block_device_msg");return false}if(cf.dev_name.value==""){alert("$device_name_null");return false}}}if(cf.dev_name.value==""){alert("$device_name_null");return false}var name_str=cf.dev_name.value;if(name_str.length>32){alert("$devname_long");return false}apply_flag=1;cf.submit();return true}function check_allow_edit(){var d=document.forms[0];if(allowed_no_connect_num==0){alert("$port_edit");return false}var c=0;var b;for(i=1;i<=allowed_no_connect_num;i++){var a="checkbox_index_white"+i;if(document.getElementById(a).checked==true){b=i+1;c++}}if(c==0||c!=1){alert("$port_edit");return false}else{access_control_apply(d,"0");d.select_edit.value=b-1;d.submit_flag.value="editnum_acc_allow";d.action="/apply.cgi?/edit_allowed.htm timestamp="+ts;d.submit();return true}}function check_block_edit(){var d=document.forms[0];if(blocked_no_connect_num==0){alert("$port_edit");return false}var c=0;var b;for(i=1;i<=blocked_no_connect_num;i++){var a="checkbox_index_black"+i;if(document.getElementById(a).checked==true){b=i+1;c++}}if(c==0||c!=1){alert("$port_edit");return false}access_control_apply(d,"0");d.select_edit.value=b-1;d.submit_flag.value="editnum_acc_block";d.action="/apply.cgi?/edit_blocked.htm timestamp="+ts;d.submit();return true}function toggle_edit(){var num=0;var cf=document.forms[0];if(access_control_device_num>0){for(var i=1;i<=access_control_device_num;i++){var listName="checkbox_index"+i;if(e=eval("document.getElementById(listName)")){if(document.getElementById(listName).checked==true){num++}}}}if(num==1){cf.edit_attached.className="common_bt";cf.edit_attached.disabled=false}else{cf.edit_attached.className="common_gray_bt";cf.edit_attached.disabled=true}}function toggle_edit_allow(){var b=0;var d=document.forms[0];if(allowed_no_connect_num>0){for(var c=1;c<=allowed_no_connect_num;c++){var a="checkbox_index_white"+c;if(document.getElementById(a).checked==true){b++}}}if(b==1){d.edit_white.className="common_bt";d.edit_white.disabled=false}else{d.edit_white.className="common_gray_bt";d.edit_white.disabled=true}}function toggle_edit_block(){var b=0;var d=document.forms[0];if(blocked_no_connect_num>0){for(var c=1;c<=blocked_no_connect_num;c++){var a="checkbox_index_black"+c;if(document.getElementById(a).checked==true){b++}}}if(b==1){d.edit_black.className="common_bt";d.edit_black.disabled=false}else{d.edit_black.className="common_gray_bt";d.edit_black.disabled=true}}function back_reload_page(a){console.log("back_flag=%s",top.back_flag);if(top.back_flag==1){location.href=a;top.back_flag=0}};