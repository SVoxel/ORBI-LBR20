function handle_on_updating(){var a=document.forms[0];if(have_openvpn_certificate==0){return}if(on_updating=="1"){if(!!a.window){a.window.className="common_gray_bt";a.window.disabled=true}if(!!a.non_window){a.non_window.className="non_window_gray_bt";a.non_window.disabled=true}if(!!a.smart_phone){a.smart_phone.className="non_window_gray_bt";a.smart_phone.disabled=true}if(!!a.Apply){a.Apply.className="apply_gray_bt";a.Apply.disabled=true}if(!!document.getElementById("updating_tip")){document.getElementById("updating_tip").style.display=""}}else{if(!!a.window){a.window.className="window_bt";a.window.disabled=false}if(!!a.non_window){a.non_window.className="non_window_bt";a.non_window.disabled=false}if(!!a.smart_phone){a.smart_phone.className="non_window_bt";a.smart_phone.disabled=false}if(!!a.Apply){a.Apply.className="apply_bt";a.Apply.disabled=false}if(!!document.getElementById("updating_tip")){document.getElementById("updating_tip").style.display="none"}}}function checkvpn(c){var b=0;var a=parseInt(c.openvpn_service_port.value,10);if(c.openvpnActive.checked==true){if(old_endis_ddns!="1"&&(old_wan_assign=="0"||(old_wan_assign=="1"&&select_basic!="1"))&&!(pppoe_get_wan_assign=="1"&&info_get_wanproto=="pppoe")){alert("$no_ddns");return false}}if(a>65534){alert("$serv_port_limit");return false}if(c.openvpnActive.checked==true){c.hidden_enable_vpn.value=1}else{c.hidden_enable_vpn.value=0}if(c.openvpn_protocol[0].checked==true){c.hidden_vpn_type.value="udp"}else{if(c.openvpn_protocol[1].checked==true){c.hidden_vpn_type.value="tcp"}}c.hidden_vpn_port.value=c.openvpn_service_port.value;if(c.openvpn_redirectGW[0].checked==true){c.hidden_vpn_access.value="auto"}else{if(c.openvpn_redirectGW[1].checked==true){c.hidden_vpn_access.value="all"}else{if(c.openvpn_redirectGW[2].checked==true){c.hidden_vpn_access.value="home"}}}if((c.openvpnActive.checked==true)&&(check_all_port(a,c.hidden_vpn_type.value)==false)){alert("$invalid_port_used");return false}if(c.openvpnActive.checked==true&&backup_rsp==""){c.hidden_backup_rspToPing.value=rspToPing_value}if((c.hidden_vpn_type.value!=type||c.hidden_vpn_port.value!=port||c.hidden_vpn_access.value!=access_mode)&&c.hidden_enable_vpn.value==1){alert("$warn_change_vpn_config")}if(c.openvpnActive.checked==true&&select_basic=="0"&&((internet_ppp_type=="0"&&wan_pppoe_demand=="1")||(internet_ppp_type=="1"&&wan_pptp_demand=="1")||(internet_ppp_type=="3"&&wan_mulpppoe_demand=="1")||(internet_ppp_type=="4"&&wan_l2tp_demand=="1"))){if(confirm("$ppp_dial_on_demand_vpn_query")==false){return false}}if(c.openvpnActive.checked==true&&select_basic=="0"&&((internet_ppp_type=="0"&&wan_pppoe_demand=="2")||(internet_ppp_type=="1"&&wan_pptp_demand=="2")||(internet_ppp_type=="3"&&wan_mulpppoe_demand=="2")||(internet_ppp_type=="4"&&wan_l2tp_demand=="2"))){alert("$ppp_dial_on_demand_vpn_warning")}return true}function check_openvpn(d){var c=0;var b=parseInt(d.vpn_port.value,10);var a=parseInt(d.tun_vpn_port.value,10);if(d.enable_vpn.checked==true){if(old_endis_ddns!="1"&&(old_wan_assign=="0"||(old_wan_assign=="1"&&select_basic!="1"))&&!(pppoe_get_wan_assign=="1"&&info_get_wanproto=="pppoe")){alert("$no_ddns");return false}}if(d.vpn_port.value==""||d.tun_vpn_port.value==""||b>65534||a>65534){alert("$serv_port_limit");return false}if(d.enable_vpn.checked==true){d.hidden_enable_vpn.value=1}else{d.hidden_enable_vpn.value=0}if(d.vpn_type[0].checked==true){d.hidden_vpn_type.value="udp"}else{if(d.vpn_type[1].checked==true){d.hidden_vpn_type.value="tcp"}}if(d.tun_vpn_type[0].checked==true){d.hidden_tun_vpn_type.value="udp"}else{if(d.tun_vpn_type[1].checked==true){d.hidden_tun_vpn_type.value="tcp"}}if(d.vpn_port.value==d.tun_vpn_port.value){alert("$same_port_warning");return false}d.hidden_vpn_port.value=d.vpn_port.value;d.hidden_tun_vpn_port.value=d.tun_vpn_port.value;if(d.vpn_access[0].checked==true){d.hidden_vpn_access.value="auto"}else{if(d.vpn_access[1].checked==true){d.hidden_vpn_access.value="all"}else{if(d.vpn_access[2].checked==true){d.hidden_vpn_access.value="home"}}}if((d.enable_vpn.checked==true)&&((check_all_port(b,d.hidden_vpn_type.value)==false)||(check_all_port(a,d.hidden_tun_vpn_type.value)==false))){alert("$invalid_port_used");return false}if(d.enable_vpn.checked==true&&backup_rsp==""){d.hidden_backup_rspToPing.value=rspToPing_value}if((d.hidden_vpn_type.value!=type||d.hidden_vpn_port.value!=port||d.hidden_vpn_access.value!=access_mode||d.hidden_tun_vpn_type.value!=tun_type||d.hidden_tun_vpn_port.value!=tun_port)&&d.hidden_enable_vpn.value==1){alert("$warn_change_vpn_config")}if(d.enable_vpn.checked==true&&select_basic=="0"&&((internet_ppp_type=="0"&&wan_pppoe_demand=="1")||(internet_ppp_type=="1"&&wan_pptp_demand=="1")||(internet_ppp_type=="3"&&wan_mulpppoe_demand=="1")||(internet_ppp_type=="4"&&wan_l2tp_demand=="1"))){if(confirm("$ppp_dial_on_demand_vpn_query")==false){return false}}if(d.enable_vpn.checked==true&&select_basic=="0"&&((internet_ppp_type=="0"&&wan_pppoe_demand=="2")||(internet_ppp_type=="1"&&wan_pptp_demand=="2")||(internet_ppp_type=="3"&&wan_mulpppoe_demand=="2")||(internet_ppp_type=="4"&&wan_l2tp_demand=="2"))){alert("$ppp_dial_on_demand_vpn_warning")}return true}function checkdownload(b,a){if(vpn_enable=="0"){alert("$no_enable_vpn");return false}if(old_endis_ddns!="1"){alert("$no_ddns_config_file")}if(a==1){b.download_button_type.value="windows"}else{if(a==2){b.download_button_type.value="nonwindows"}else{if(a==3){b.download_button_type.value="smartphone"}}}b.action="/apply.cgi?/vpn_frame.htm timestamp="+ts;b.submit_flag.value="vpn_compress_conf";b.submit();return true}function check_all_port(b,c){var a=true;if(check_vpn_port_range("forwardingArray",forward_array_num,b,c)==false){a=false}if(check_vpn_port_range("triggeringArray",trigger_array_num,b,c)==false){a=false}if(check_vpn_port_range("upnpArray",upnp_array_num,b,c)==false){a=false}if(usb_router_flag==1){if(c!="UDP"){if(check_readyshare_port(b,b,"ALL")==false){a=false}}}if(endis_remote=="1"&&c!="UDP"&&parseInt(remote_port)==b){a=false}if(b==123&&endis_ntp=="1"&&c!="TCP"){a=false}if(b==1900&&endis_upnp=="1"&&c!="TCP"){a=false}if(b==5050&&info_get_wanproto=="bigpond"&&c!="TCP"){a=false}return a}function check_vpn_port_range(name,length,port_using,type){var i,str,each_info,sertype,startport,endport,serflag;for(i=1;i<=length;i++){switch(name){case"forwardingArray":str=eval(name+i);each_info=str.split(" ");sertype=each_info[1];startport=each_info[2];endport=each_info[3];break;case"triggeringArray":str=eval(name+i);each_info=str.split(" ");sertype=each_info[5];startport=each_info[6];endport=each_info[7];break;case"upnpArray":str=eval(name+i);each_info=str.split(";");sertype=each_info[1];startport=each_info[3];endport=each_info[3];break;default:break}if(sertype==type||sertype=="TCP/UDP"){if(parseInt(startport)<=parseInt(port_using)&&parseInt(endport)>=parseInt(port_using)){return false}}}return true};