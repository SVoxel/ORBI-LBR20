function show_subnet_trustedip(){var a=document.forms[0];var b=new Array();b=lan_subnet.split(".");if(a.trustipenble.checked){if(parseInt(b[0])!=255){a.cfTrusted_IPAddress1.disabled=false}if(parseInt(b[1])!=255){a.cfTrusted_IPAddress2.disabled=false}if(parseInt(b[2])!=255){a.cfTrusted_IPAddress3.disabled=false}if(parseInt(b[3])!=255){a.cfTrusted_IPAddress4.disabled=false}}else{a.cfTrusted_IPAddress1.disabled=true;a.cfTrusted_IPAddress2.disabled=true;a.cfTrusted_IPAddress3.disabled=true;a.cfTrusted_IPAddress4.disabled=true}}function show_trustedip(){var a=document.forms[0];if(endis_Trusted_IP=="0"){a.trustipenble.checked=false;a.cfTrusted_IPAddress1.value=lanip_array[0];a.cfTrusted_IPAddress2.value=lanip_array[1];a.cfTrusted_IPAddress3.value=lanip_array[2];a.cfTrusted_IPAddress4.value=""}else{a.trustipenble.checked=true;a.cfTrusted_IPAddress1.value=trustedip_array[0];a.cfTrusted_IPAddress2.value=trustedip_array[1];a.cfTrusted_IPAddress3.value=trustedip_array[2];a.cfTrusted_IPAddress4.value=trustedip_array[3]}show_subnet_trustedip()}function trim(a){while((a.indexOf(" ")==0)&&(a.length>1)){a=a.substring(1,a.length)}while((a.lastIndexOf(" ")==a.length-1)&&(a.length>1)){a=a.substring(0,a.length-1)}if(a==" "){a=""}return a}function check_blocksites(){var c=document.forms[0];c.cfTrusted_IPAddress.value="";if(c.trustipenble.checked==true){c.Trusted_IP_Enable.value=1;c.cfTrusted_IPAddress.value=c.cfTrusted_IPAddress1.value+"."+c.cfTrusted_IPAddress2.value+"."+c.cfTrusted_IPAddress3.value+"."+c.cfTrusted_IPAddress4.value;if(checkipaddr(c.cfTrusted_IPAddress.value)==false||is_sub_or_broad(c.cfTrusted_IPAddress.value,lan_ip,lan_subnet)==false||isSameIp(c.cfTrusted_IPAddress.value,lan_ip)==true){alert("$invalid_ip");return false}if(isSameSubNet(c.cfTrusted_IPAddress.value,lan_subnet,lan_ip,lan_subnet)==false){alert("$same_subnet_ip_trusted");return false}}else{c.Trusted_IP_Enable.value=0}c.Text.value="";if(c.cfKeyWord_DomainList.length>0){if(c.cfKeyWord_DomainList.length>255){alert("$keyword255");c.cfKeyWord_Domain.value="";return false}for(i=0;i<c.cfKeyWord_DomainList.length-1;i++){if(c.cfKeyWord_DomainList.options[i].value!=""){var a=trim(c.cfKeyWord_DomainList.options[i].value);var b=encodeURI(a);c.Text.value+=b+" "}}var a=trim(c.cfKeyWord_DomainList.options[i].value);var b=encodeURI(a);c.Text.value+=b}for(i=0;i<3;i++){if(document.forms[0].skeyword[i].checked==true){c.skeyword.value=i}}if(is_jp_version==1){if(c.session[0].checked==true){c.session.value="session1"}else{c.session.value="session2"}}c.submit();return true}function checkKeyWord(){var d=document.forms[0];var g=d.cfKeyWord_DomainList;var b=d.cfKeyWord_DomainList.length;if(b==255){alert("$keyword255");d.cfKeyWord_Domain.value="";return false}if(d.cfKeyWord_Domain.value==""||d.cfKeyWord_Domain.value.length>60){return false}for(c=0;c<d.cfKeyWord_Domain.value.length;c++){if(isValidChar_space(d.cfKeyWord_Domain.value.charCodeAt(c))==false){alert("$error_keyword");return false}}var a=d.cfKeyWord_Domain.value;var e=a.toLowerCase();if(e.indexOf("://")>0&&e.length>7){if(e.substring(0,7)=="http://"){a=a.substr(7)}else{if(e.substring(0,8)=="https://"){a=a.substr(8)}}}for(var c=0;c<b;c++){if(a==g.options[c].value){d.cfKeyWord_Domain.value="";return false}}if(b==1&&g.options[0].value==""){var f=0}else{var f=b}g.options[f]=new Option(a,a);d.cfKeyWord_Domain.value="";return true}function checkKeyWordDomainList(b){var d=document.forms[0];d.cfKeyWord_Domain.value="";if(d.cfKeyWord_DomainList.options[0]==null){if(b=="delete"){alert("$port_del")}return false}if(b=="delete"&&d.cfKeyWord_DomainList.selectedIndex!=-1){d.cfKeyWord_DomainList.options[d.cfKeyWord_DomainList.selectedIndex]=null}else{if(b=="delete"){alert("$port_del");return false}}if(b=="clear"){var a=d.cfKeyWord_DomainList.length;for(var c=0;c<a;c++){d.cfKeyWord_DomainList.options[0]=null}}return true}function checkTrustIP(){show_subnet_trustedip()};