function show_hidden_help_top_button(b){if(!isIE_or_Opera()||IE_version()>=8){Not_IE_show_hidden_help(b)}else{var a=top.document.getElementById("formframe_div").style.height.replace(/px/,"");if(b%2==0){document.getElementById("main").style.height=a-285;document.getElementById("help").style.display="";document.getElementById("help_switch").className="open_help"}else{document.getElementById("help").style.display="none";document.getElementById("help_switch").className="close_help";document.getElementById("main").style.height=a-165}}}function myip_update(b){var a=document.forms[0];if((a.myip_1.value.length>0)&&(a.myip_2.value.length>0)&&(a.myip_3.value.length>0)&&(a.myip_4.value.length>0)){setDisabled(false,a.mygw_1,a.mygw_2,a.mygw_3,a.mygw_4);if(russian_ppp_flag==1&&b=="bas"){setDisabled(false,a.mymask_1,a.mymask_2,a.mymask_3,a.mymask_4);pptp_servip_update()}}else{setDisabled(true,a.mygw_1,a.mygw_2,a.mygw_3,a.mygw_4);if(russian_ppp_flag==1&&b=="bas"){setDisabled(true,a.mymask_1,a.mymask_2,a.mymask_3,a.mymask_4);pptp_servip_update()}}}function change_pptp_password(a){if(a.type=="password"){if(get_browser()=="Firefox"){a.value="";a.type="text"}else{a.outerHTML='<input type="text" name="pptp_passwd" maxlength="50" size="16" onFocus="this.select();change_pptp_password(this);" onKeyPress="return getkey(\'ssid\', event)" value="">';document.forms[0].pptp_passwd.select()}}document.forms[0].hidden_pwd_change.value="1"}function pptp_servip_update(){var b=false;var d=document.forms[0];var c=d.pptp_serv_ip.value.split(".");if(c.length==4){var a=0;for(iptab=0;iptab<4;iptab++){if(isNumeric(c[iptab],255)){a++}}if(a==4){if(checkipaddr(d.pptp_serv_ip.value)==false){b=true}}else{b=true}}else{if(d.pptp_serv_ip.value.length>0){b=true}}if(russian_ppp_flag==1&&(netgear_region=="RU"||(netgear_region=="WW"&&gui_region=="Russian"))){if(b==true&&d.myip_1.value==""){b=false}setDisabled(b,d.DNSAssign[0]);if(b==true&&d.DNSAssign[1].checked==false){d.DNSAssign[1].checked=true;setDNS(d)}}}function setDNS(b){var a=b.DNSAssign[0].checked;setDisabled(a,b.DAddr1,b.DAddr2,b.DAddr3,b.DAddr4,b.PDAddr1,b.PDAddr2,b.PDAddr3,b.PDAddr4);DisableFixedDNS=a}function is_IP_addr(d){var c,b,a;for(c=0;c<d.length;c++){for(b=0;b<d[c].length;b++){a=d[c].charAt(b);if("0123456789".indexOf(a,0)<0){return false}}}return true}function check_wizard_pptp(c,h){var g=document.forms[0];if(g.pptp_username.value==""){alert("$login_name_null");return false}for(d=0;d<g.pptp_username.value.length;d++){if(isValidChar(g.pptp_username.value.charCodeAt(d))==false){alert("$loginname_not_allowed");return false}}for(d=0;d<g.pptp_passwd.value.length;d++){if(isValidChar(g.pptp_passwd.value.charCodeAt(d))==false){alert("$password_error");return false}}if(g.pptp_dod.value=="1"){if(g.pptp_idletime.value.length<=0){alert("$idle_time_null");return false}else{if(!_isNumeric(g.pptp_idletime.value)){alert("$invalid_idle_time");return false}}}g.pptp_myip.value=g.myip_1.value+"."+g.myip_2.value+"."+g.myip_3.value+"."+g.myip_4.value;g.pptp_gateway.value=g.mygw_1.value+"."+g.mygw_2.value+"."+g.mygw_3.value+"."+g.mygw_4.value;if(russian_ppp_flag==1&&h=="bas"){g.pptp_subnet.value=g.mymask_1.value+"."+g.mymask_2.value+"."+g.mymask_3.value+"."+g.mymask_4.value}else{g.pptp_subnet.value=""}if(g.pptp_subnet.value==""||g.pptp_subnet.value=="..."){var a="255.255.255.0";if(parseInt(g.myip_1.value)<128){a="255.0.0.0"}else{if(parseInt(g.myip_1.value)<192){a="255.255.0.0"}else{a="255.255.255.0"}}g.pptp_subnet.value=a}if(g.pptp_myip.value!="..."){g.WANAssign.value=1;if(checkipaddr(g.pptp_myip.value)==false){alert("$invalid_myip");return false}if(isSameSubNet(g.pptp_myip.value,lan_subnet,lan_ip,lan_subnet)==true){g.conflict_wanlan.value=1}if(isSameIp(g.pptp_myip.value,lan_ip)==true){g.conflict_wanlan.value=1}if(russian_ppp_flag==1&&h=="bas"){if(checksubnet(g.pptp_subnet.value,1)==false){alert("$invalid_mask");return false}if(isSameSubNet(g.pptp_myip.value,g.pptp_subnet.value,lan_ip,g.pptp_subnet.value)==true){g.conflict_wanlan.value=1}if(isSameSubNet(g.pptp_myip.value,g.pptp_subnet.value,lan_ip,lan_subnet)==true){g.conflict_wanlan.value=1}}if(g.pptp_gateway.value!="..."&&(checkgateway(g.pptp_gateway.value)==false||is_sub_or_broad(g.pptp_gateway.value,g.pptp_gateway.value,g.pptp_subnet.value)==false)){alert("$invalid_gateway");return false}if(g.pptp_gateway.value!="..."){if(isSameIp(g.pptp_myip.value,g.pptp_gateway.value)==true){alert("$invalid_gateway");return false}g.pptp_gateway.value=address_parseInt(g.pptp_gateway.value)}g.pptp_myip.value=address_parseInt(g.pptp_myip.value);g.pptp_subnet.value=address_parseInt(g.pptp_subnet.value)}else{g.pptp_myip.value="";g.pptp_gateway.value="";g.pptp_subnet.value="";g.WANAssign.value=0}if(g.pptp_serv_ip.value==""){alert("$invalid_servip");return false}for(d=0;d<g.pptp_serv_ip.value.length;d++){if(isValidDdnsHost(g.pptp_serv_ip.value.charCodeAt(d))==false){alert("$invalid_servip");return false}}if(g.pptp_serv_ip.value==g.pptp_myip.value){alert("$same_server_wan_ip");return false}var e=g.pptp_serv_ip.value.split(".");var d;var f=0;for(d=0;d<e.length;d++){if(e[d].length>63){alert("$invalid_servip_length");return false}}if(e.length==4){var b=0;for(iptab=0;iptab<4;iptab++){if(isNumeric(e[iptab],255)){b++}}if(b==4){if(checkipaddr(g.pptp_serv_ip.value)==true){if(g.pptp_myip.value!=""){if(g.pptp_gateway.value=="..."||g.pptp_gateway.value==""){alert("$invalid_gateway");return false}}}}}if(c==1){g.run_test.value="test";if(h=="wiz"){g.action="/apply.cgi?/WIZ_update.htm timestamp="+ts}}else{g.run_test.value="no"}return true}function check_pptp(c,a){format_IP("myip_1","myip_2","myip_3","myip_4","mymask_1","mymask_2","mymask_3","mymask_4","mygw_1","mygw_2","mygw_3","mygw_4","DAddr1","DAddr2","DAddr3","DAddr4","PDAddr1","PDAddr2","PDAddr3","PDAddr4");if(c.auto_conn_24hr.checked==true){c.hidden_auto_conn_flag.value=1}else{c.hidden_auto_conn_flag.value=0}c.hidden_conn_time_num.value=c.auto_conn_time.selectedIndex;var d=false;if(check_wizard_pptp(a,"bas")==false){return false}c.hidden_pptp_idle_time.value=parseInt(c.pptp_idletime.value,10);c.hid_pptp_dod.value=c.pptp_dod.value;if(check_wan_type_apply(c.hid_pptp_dod.value)==false){return false}if(c.WANAssign.value==1){d=true}if(c.DNSAssign[1].checked==true){c.pptp_dnsaddr1.value=c.DAddr1.value+"."+c.DAddr2.value+"."+c.DAddr3.value+"."+c.DAddr4.value;c.pptp_dnsaddr2.value=c.PDAddr1.value+"."+c.PDAddr2.value+"."+c.PDAddr3.value+"."+c.PDAddr4.value;if(c.pptp_dnsaddr1.value=="..."){c.pptp_dnsaddr1.value=""}else{c.pptp_dnsaddr1.value=address_parseInt(c.pptp_dnsaddr1.value)}if(c.pptp_dnsaddr2.value=="..."){c.pptp_dnsaddr2.value=""}else{c.pptp_dnsaddr2.value=address_parseInt(c.pptp_dnsaddr2.value)}if(!check_DNS(c.pptp_dnsaddr1.value,c.pptp_dnsaddr2.value,d,c.pptp_myip.value)){return false}if(c.WANAssign.value==1){if((c.pptp_dnsaddr1.value!=""&&!isSameSubNet(c.pptp_dnsaddr1.value,c.pptp_subnet.value,c.pptp_myip.value,c.pptp_subnet.value))||(c.pptp_dnsaddr2.value!=""&&!isSameSubNet(c.pptp_dnsaddr2.value,c.pptp_subnet.value,c.pptp_myip.value,c.pptp_subnet.value))){if(c.pptp_gateway.value==""||c.pptp_gateway.value=="..."){alert("$invalid_gateway");return false}}}}if(c.MACAssign[2].checked){the_mac=c.Spoofmac.value;if(the_mac.indexOf(":")==-1&&the_mac.length=="12"){var b=the_mac.substr(0,2)+":"+the_mac.substr(2,2)+":"+the_mac.substr(4,2)+":"+the_mac.substr(6,2)+":"+the_mac.substr(8,2)+":"+the_mac.substr(10,2);c.Spoofmac.value=b}else{if(the_mac.split("-").length==6){var b=the_mac.replace(/-/g,":");c.Spoofmac.value=b}}if(maccheck_multicast(c.Spoofmac.value)==false){return false}}c.hid_mtu_value.value=wan_mtu_now;if(!(old_wan_type=="pptp")){c.change_wan_type.value=0;mtu_change(wanproto_type)}else{c.change_wan_type.value=1}c.hid_enable_vpn.value=vpn_enable;if(old_endis_ddns!="1"&&vpn_enable=="1"){if(confirm("$no_change_static_ip")==true){c.hid_enable_vpn.value="0"}else{c.hid_enable_vpn.value="1";return false}}if(c.pptp_dod.value=="1"||c.pptp_dod.value=="2"){if(readycloud_enable=="1"||vpn_enable=="1"||upnp_enableMedia=="1"||parent.geniecloud_flag==1){if(confirm("$ppp_dial_on_demand_query")==false){return false}}}c.Apply.disabled=true;c.submit();return true}function setIP_welcome_pptp(){var b=document.forms[0];var a=b.WANAssign[0].checked;setDisabled(a,b.myip_1,b.myip_2,b.myip_3,b.myip_4);DisableFixedIP=a}function check_welcome_pptp(){var a=document.forms[0];if(check_wizard_pptp(0,"welcome")==false){return false}parent.pptp_username=a.pptp_username.value;parent.pptp_password=a.pptp_passwd.value;parent.pptp_idle_time=a.pptp_idletime.value;a.pptp_myip.value=a.myip_1.value+"."+a.myip_2.value+"."+a.myip_3.value+"."+a.myip_4.value;if(a.pptp_myip.value=="..."){a.pptp_myip.value="";a.WANAssign.value=0;parent.pptp_wan_assign=0}else{a.WANAssign.value=1;parent.pptp_wan_assign=1}parent.pptp_local_ipaddr=a.pptp_myip.value;parent.pptp_local_gateway=a.pptp_gateway.value;parent.pptp_server_ipaddr=a.pptp_serv_ip.value;parent.pptp_connect_id=a.pptp_conn_id.value;parent.welcome_wan_type=4;return true}function RU_pptp_user_info(){var c=document.forms[0];if(c.pptp_username.value==""){alert(login_name_null);return false}for(a=0;a<c.pptp_username.value.length;a++){if(isValidChar(c.pptp_username.value.charCodeAt(a))==false){alert(loginname_not_allowed);return false}}for(a=0;a<c.pptp_passwd.value.length;a++){if(isValidChar(c.pptp_passwd.value.charCodeAt(a))==false){alert(password_not_allowed);return false}}if(c.pptp_serv_ip.value==""){alert(invalid_servip);return false}for(a=0;a<c.pptp_serv_ip.value.length;a++){if(isValidChar(c.pptp_serv_ip.value.charCodeAt(a))==false){alert(invalid_servip);return false}}var b=c.pptp_serv_ip.value.split(".");var a;for(a=0;a<b.length;a++){if(b[a].length>63){alert(invalid_servip);return false}}parent.pptp_username=c.pptp_username.value;parent.pptp_password=c.pptp_passwd.value;parent.pptp_server_ipaddr=c.pptp_serv_ip.value;parent.welcome_wan_type=4;if(parent.isp_type=="12"){c.basic_type.value="0";c.ppp_login_type.value="1";c.welcome_wan_type.value="4";c.pptp_dnsaddr1.value=parent.static_dns1;c.pptp_dnsaddr2.value=parent.static_dns2;if(c.pptp_dnsaddr1.value!=""||c.pptp_dnsaddr2.value!=""){c.DNSAssign.value="1"}else{c.DNSAssign.value="0"}c.WANAssign.value="0";c.STATIC_DNS.value="0";c.submit()}else{if(parent.isp_type=="11"){location.href="RU_isp_spoof.htm"}else{if(parent.isp_type=="9"||parent.isp_type=="10"){location.href="RU_isp_pptp_static.htm"}else{location.href="RU_manu_local_resources.htm"}}}}function setIP(b){var a=b.DualAssign[0].checked;setDisabled(a,b.myip_1,b.myip_2,b.myip_3,b.myip_4,b.mymask_1,b.mymask_2,b.mymask_3,b.mymask_4,b.mygw_1,b.mygw_2,b.mygw_3,b.mygw_4);DisableFixedIP=a;if(!document.getElementsByTagName("span")[0]){return false}if(b.DualAssign[1].checked){b.DNSAssign[1].checked=true;setDNS(b);b.DNSAssign[0].disabled=true;document.getElementsByTagName("span")[0].style.color="gray"}else{document.getElementsByTagName("span")[0].style.color="black";b.DNSAssign[0].disabled=false}}function RU_pptp_servip_FQDN(a){var b=document.forms[0];servName=b.pptp_serv_ip.value;if(servName.search(/[A-Za-z]/i)!=-1){parent.pptp_server_FQDN=1}else{parent.pptp_server_FQDN=0}}function RU_pptp_servip_update(a){var b=document.forms[0];if((parent.pptp_server_FQDN==1)&&((b.myip_1.value.length>0)||(b.myip_2.value.length>0)||(b.myip_3.value.length>0)||(b.myip_4.value.length>0))){if(b.DNSAssign[0].checked==true){b.DAddr1.disabled=false;b.DAddr2.disabled=false;b.DAddr3.disabled=false;b.DAddr4.disabled=false;b.PDAddr1.disabled=false;b.PDAddr2.disabled=false;b.PDAddr3.disabled=false;b.PDAddr4.disabled=false}b.DNSAssign[0].checked=false;b.DNSAssign[1].checked=true;b.DNSAssign[0].disabled=true;b.STATIC_DNS.value=1}else{b.DNSAssign[0].disabled=false;b.STATIC_DNS.value=0}}function RU_check_pptp_dual(){var a=document.forms[0];var b=false;a.pptp_myip.value=a.myip_1.value+"."+a.myip_2.value+"."+a.myip_3.value+"."+a.myip_4.value;a.pptp_mynetmask.value=a.mymask_1.value+"."+a.mymask_2.value+"."+a.mymask_3.value+"."+a.mymask_4.value;a.pptp_gateway.value=a.mygw_1.value+"."+a.mygw_2.value+"."+a.mygw_3.value+"."+a.mygw_4.value;if(a.DualAssign[1].checked==true){b=true;parent.pptp_wan_assign=1;if(checkipaddr(a.pptp_myip.value)==false){alert(invalid_myip);return false}if(isSameSubNet(a.pptp_myip.value,lan_subnet,lan_ip,lan_subnet)==true){a.conflict_wanlan.value=1}if(isSameIp(a.pptp_myip.value,lan_ip)==true){a.conflict_wanlan.value=1}if(isSameSubNet(a.pptp_myip.value,a.pptp_mynetmask.value,lan_ip,a.pptp_mynetmask.value)==true){a.conflict_wanlan.value=1}if(isSameSubNet(a.pptp_myip.value,a.pptp_mynetmask.value,lan_ip,lan_subnet)==true){a.conflict_wanlan.value=1}if(checksubnet(a.pptp_mynetmask.value)==false){alert(invalid_mask);return false}if(a.pptp_gateway.value!="..."&&(checkgateway(a.pptp_gateway.value)==false||is_sub_or_broad(a.pptp_gateway.value,a.pptp_gateway.value,a.pptp_mynetmask.value)==false)){alert(invalid_gateway);return false}if(a.pptp_gateway.value!="..."){if(isSameIp(a.pptp_myip.value,a.pptp_gateway.value)==true){alert(invalid_gateway);return false}}else{a.pptp_gateway.value=""}}else{a.pptp_myip.value="";a.pptp_mynetmask.value="";a.pptp_gateway.value="";parent.pptp_wan_assign=0}if(a.DNSAssign[1].checked==true){a.pptp_dnsaddr1.value=a.DAddr1.value+"."+a.DAddr2.value+"."+a.DAddr3.value+"."+a.DAddr4.value;a.pptp_dnsaddr2.value=a.PDAddr1.value+"."+a.PDAddr2.value+"."+a.PDAddr3.value+"."+a.PDAddr4.value;if(a.pptp_dnsaddr1.value=="..."){a.pptp_dnsaddr1.value=""}if(a.pptp_dnsaddr2.value=="..."){a.pptp_dnsaddr2.value=""}if(!check_RU_DNS(a.pptp_dnsaddr1.value,a.pptp_dnsaddr2.value,b,a.pptp_myip.value)){return false}}else{a.pptp_dnsaddr1.value="";a.pptp_dnsaddr2.value=""}if(a.DualAssign[1].checked==true){alert(attention_static_ip)}parent.pptp_local_ipaddr=a.pptp_myip.value;parent.pptp_local_netmask=a.pptp_mynetmask.value;parent.pptp_local_gateway=a.pptp_gateway.value;parent.pptp_dns1=a.pptp_dnsaddr1.value;parent.pptp_dns2=a.pptp_dnsaddr2.value;parent.STATIC_DNS=a.STATIC_DNS.value;parent.conflict_wanlan=a.conflict_wanlan.value;location.href="RU_manual_spoof.htm"};