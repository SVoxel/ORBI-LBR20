function show_hidden_help(b){if(!isIE_or_Opera()||IE_version()>=9){Not_IE_show_hidden_help(b)}else{var a=top.document.getElementById("formframe_div").style.height.replace(/px/,"");if(b%2==0){document.getElementById("main").style.height=a-285;document.getElementById("help").style.display="";document.getElementById("help_switch").className="open_help"}else{document.getElementById("help").style.display="none";document.getElementById("help_switch").className="close_help";document.getElementById("main").style.height=a-165}}}function is_IP_addr(d){var c,b,a;for(c=0;c<d.length;c++){for(b=0;b<d[c].length;b++){a=d[c].charAt(b);if("0123456789".indexOf(a,0)<0){return false}}}return true}function myip_update(b){var a=document.forms[0];if((a.myip_1.value.length>0)&&(a.myip_2.value.length>0)&&(a.myip_3.value.length>0)&&(a.myip_4.value.length>0)){setDisabled(false,a.mygw_1,a.mygw_2,a.mygw_3,a.mygw_4);setDisabled(false,a.mymask_1,a.mymask_2,a.mymask_3,a.mymask_4);l2tp_servip_update()}else{setDisabled(true,a.mygw_1,a.mygw_2,a.mygw_3,a.mygw_4);setDisabled(true,a.mymask_1,a.mymask_2,a.mymask_3,a.mymask_4);l2tp_servip_update()}}function change_l2tp_password(a){if(a.type=="password"){if(get_browser()=="Firefox"){a.value="";a.type="text"}else{a.outerHTML='<input type="text" name="l2tp_passwd" maxlength="50" size="16" onFocus="this.select();change_l2tp_password(this);" onKeyPress="return getkey(\'ssid\', event)" value="">';document.forms[0].l2tp_passwd.select()}}document.forms[0].hidden_pwd_change.value="1"}function l2tp_servip_update(){var b=false;var d=document.forms[0];var c=d.l2tp_serv_ip.value.split(".");if(c.length==4){var a=0;for(iptab=0;iptab<4;iptab++){if(isNumeric(c[iptab],255)){a++}}if(a==4){if(checkipaddr(d.l2tp_serv_ip.value)==false){b=true}}else{b=true}}else{if(d.l2tp_serv_ip.value.length>0){b=true}}if(b==true&&d.myip_1.value==""){b=false}setDisabled(b,d.DNSAssign[0]);if(b==true&&d.DNSAssign[1].checked==false){d.DNSAssign[1].checked=true;setDNS(d)}}function setDNS(b){var a=b.DNSAssign[0].checked;setDisabled(a,b.DAddr1,b.DAddr2,b.DAddr3,b.DAddr4,b.PDAddr1,b.PDAddr2,b.PDAddr3,b.PDAddr4);DisableFixedDNS=a}function check_wizard_pptp(c,g){var f=document.forms[0];if(f.l2tp_username.value==""){alert("$login_name_null");return false}for(i=0;i<f.l2tp_username.value.length;i++){if(isValidChar(f.l2tp_username.value.charCodeAt(i))==false){alert("$loginname_not_allowed");return false}}for(i=0;i<f.l2tp_passwd.value.length;i++){if(isValidChar(f.l2tp_passwd.value.charCodeAt(i))==false){alert("$password_error");return false}}if(f.l2tp_dod.value=="1"){if(f.l2tp_idletime.value.length<=0){alert("$idle_time_null");return false}else{if(!_isNumeric(f.l2tp_idletime.value)){alert("$invalid_idle_time");return false}}}f.l2tp_myip.value=f.myip_1.value+"."+f.myip_2.value+"."+f.myip_3.value+"."+f.myip_4.value;f.l2tp_gateway.value=f.mygw_1.value+"."+f.mygw_2.value+"."+f.mygw_3.value+"."+f.mygw_4.value;f.l2tp_subnet.value=f.mymask_1.value+"."+f.mymask_2.value+"."+f.mymask_3.value+"."+f.mymask_4.value;if(f.l2tp_myip.value!="..."){f.WANAssign.value=1;if(checkipaddr(f.l2tp_myip.value)==false){alert("$invalid_myip");return false}if(isSameSubNet(f.l2tp_myip.value,lan_subnet,lan_ip,lan_subnet)==true){f.conflict_wanlan.value=1}if(isSameIp(f.l2tp_myip.value,lan_ip)==true){f.conflict_wanlan.value=1}if(f.l2tp_subnet.value=="..."){if(parseInt(f.myip_1.value)<128){f.l2tp_subnet.value="255.0.0.0"}else{if(parseInt(f.myip_1.value)<192){f.l2tp_subnet.value="255.255.0.0"}else{f.l2tp_subnet.value="255.255.255.0"}}}if(checksubnet(f.l2tp_subnet.value,1)==false){alert("$invalid_mask");return false}if(isSameSubNet(f.l2tp_myip.value,f.l2tp_subnet.value,lan_ip,f.l2tp_subnet.value)==true){f.conflict_wanlan.value=1}if(isSameSubNet(f.l2tp_myip.value,f.l2tp_subnet.value,lan_ip,lan_subnet)==true){f.conflict_wanlan.value=1}if(f.l2tp_gateway.value!="..."&&(checkgateway(f.l2tp_gateway.value)==false||is_sub_or_broad(f.l2tp_gateway.value,f.l2tp_gateway.value,f.l2tp_subnet.value)==false)){alert("$invalid_gateway");return false}if(f.l2tp_gateway.value!="..."){var a="255.255.255.0";a=f.l2tp_subnet.value;if(isSameIp(f.l2tp_myip.value,f.l2tp_gateway.value)==true){alert("$invalid_gateway");return false}}}else{f.l2tp_myip.value="";f.l2tp_gateway.value="";f.l2tp_subnet.value="";f.WANAssign.value=0}if(f.l2tp_serv_ip.value==""){alert("$invalid_servip");return false}for(i=0;i<f.l2tp_serv_ip.value.length;i++){if(isValidChar(f.l2tp_serv_ip.value.charCodeAt(i))==false){alert("$invalid_servip");return false}}if(f.l2tp_serv_ip.value==f.l2tp_myip.value){alert("$same_server_wan_ip");return false}var d=f.l2tp_serv_ip.value.split(".");var e=0;if(d.length==4){var b=0;for(iptab=0;iptab<4;iptab++){if(isNumeric(d[iptab],255)){b++}}if(b==4||(is_IP_addr(d)==true)){if(checkipaddr(f.l2tp_serv_ip.value)==true){if(f.l2tp_myip.value!=""){if(f.l2tp_gateway.value=="..."||f.l2tp_gateway.value==""){alert("$invalid_gateway");return false}}}}}if(c==1){f.run_test.value="test";if(g=="wiz"){f.action="/apply.cgi?/WIZ_update.htm timestamp="+ts}}else{f.run_test.value="no"}return true}function check_l2tp(e,a){format_IP("myip_1","myip_2","myip_3","myip_4","mymask_1","mymask_2","mymask_3","mymask_4","mygw_1","mygw_2","mygw_3","mygw_4","DAddr1","DAddr2","DAddr3","DAddr4","PDAddr1","PDAddr2","PDAddr3","PDAddr4");if(e.auto_conn_24hr.checked==true){e.hidden_auto_conn_flag.value=1}else{e.hidden_auto_conn_flag.value=0}e.hidden_conn_time_num.value=e.auto_conn_time.selectedIndex;if(check_wan_type_apply(e.l2tp_dod.value)==false){return false}var f=false;if(check_wizard_pptp(a,"bas")==false){return false}e.hidden_l2tp_idle_time.value=e.l2tp_idletime.value;if(e.WANAssign.value==1){f=true}var c=e.l2tp_serv_ip.value.split(".");var b;for(b=0;b<c.length;b++){if(c[b].length>63){alert("$invalid_servip_length");return false}}for(b=0;b<e.l2tp_serv_ip.value.length;b++){if(isValidDdnsHost(e.l2tp_serv_ip.value.charCodeAt(b))==false){alert("$invalid_servip");return false}}if(e.DNSAssign[1].checked==true){e.l2tp_dnsaddr1.value=e.DAddr1.value+"."+e.DAddr2.value+"."+e.DAddr3.value+"."+e.DAddr4.value;e.l2tp_dnsaddr2.value=e.PDAddr1.value+"."+e.PDAddr2.value+"."+e.PDAddr3.value+"."+e.PDAddr4.value;if(e.l2tp_dnsaddr1.value=="..."){e.l2tp_dnsaddr1.value=""}if(e.l2tp_dnsaddr2.value=="..."){e.l2tp_dnsaddr2.value=""}if(!check_DNS(e.l2tp_dnsaddr1.value,e.l2tp_dnsaddr2.value,f,e.l2tp_myip.value)){return false}if(e.WANAssign.value==1){if((e.l2tp_dnsaddr1.value!=""&&!isSameSubNet(e.l2tp_dnsaddr1.value,e.l2tp_subnet.value,e.l2tp_myip.value,e.l2tp_subnet.value))||(e.l2tp_dnsaddr2.value!=""&&!isSameSubNet(e.l2tp_dnsaddr2.value,e.l2tp_subnet.value,e.l2tp_myip.value,e.l2tp_subnet.value))){if(e.l2tp_gateway.value==""||e.l2tp_gateway.value=="..."){alert("$invalid_gateway");return false}}}}if(e.MACAssign[2].checked){the_mac=e.Spoofmac.value;if(the_mac.indexOf(":")==-1&&the_mac.length=="12"){var d=the_mac.substr(0,2)+":"+the_mac.substr(2,2)+":"+the_mac.substr(4,2)+":"+the_mac.substr(6,2)+":"+the_mac.substr(8,2)+":"+the_mac.substr(10,2);e.Spoofmac.value=d}else{if(the_mac.split("-").length==6){var d=the_mac.replace(/-/g,":");e.Spoofmac.value=d}}if(maccheck_multicast(e.Spoofmac.value)==false){return false}}e.hid_mtu_value.value=wan_mtu_now;if(!(old_wan_type=="l2tp")){e.change_wan_type.value=0;mtu_change(wanproto_type)}else{e.change_wan_type.value=1}e.hid_enable_vpn.value=vpn_enable;if(old_endis_ddns!="1"&&vpn_enable=="1"){if(confirm("$no_change_static_ip")==true){e.hid_enable_vpn.value="0"}else{e.hid_enable_vpn.value="1";return false}}if(e.l2tp_dod.value=="1"||e.l2tp_dod.value=="2"){if(readycloud_enable=="1"||vpn_enable=="1"||upnp_enableMedia=="1"||parent.geniecloud_flag==1){if(confirm("$ppp_dial_on_demand_query")==false){return false}}}e.Apply.disabled=true;e.submit();return true}function setIP_welcome_pptp(){var b=document.forms[0];var a=b.WANAssign[0].checked;setDisabled(a,b.myip_1,b.myip_2,b.myip_3,b.myip_4);DisableFixedIP=a}function check_welcome_pptp(){var a=document.forms[0];if(check_wizard_pptp(0,"welcome")==false){return false}parent.l2tp_username=a.l2tp_username.value;parent.pptp_password=a.l2tp_passwd.value;parent.pptp_idle_time=a.l2tp_idletime.value;a.l2tp_myip.value=a.myip_1.value+"."+a.myip_2.value+"."+a.myip_3.value+"."+a.myip_4.value;if(a.l2tp_myip.value=="..."){a.l2tp_myip.value="";a.WANAssign.value=0;parent.pptp_wan_assign=0}else{a.WANAssign.value=1;parent.pptp_wan_assign=1}parent.pptp_local_ipaddr=a.l2tp_myip.value;parent.pptp_local_gateway=a.l2tp_gateway.value;parent.pptp_server_ipaddr=a.l2tp_serv_ip.value;parent.welcome_wan_type=4;return true}function RU_l2tp_user_info(){var c=document.forms[0];if(c.l2tp_username.value==""){alert(login_name_null);return false}for(a=0;a<c.l2tp_username.value.length;a++){if(isValidChar(c.l2tp_username.value.charCodeAt(a))==false){alert(loginname_not_allowed);return false}}for(a=0;a<c.l2tp_passwd.value.length;a++){if(isValidChar(c.l2tp_passwd.value.charCodeAt(a))==false){alert(password_not_allowed);return false}}if(c.l2tp_serv_ip.value==""){alert(invalid_servip);return false}for(a=0;a<c.l2tp_serv_ip.value.length;a++){if(isValidChar(c.l2tp_serv_ip.value.charCodeAt(a))==false){alert(invalid_servip);return false}}var b=c.l2tp_serv_ip.value.split(".");var a;for(a=0;a<b.length;a++){if(b[a].length>63){alert(invalid_servip);return false}}parent.l2tp_username=c.l2tp_username.value;parent.l2tp_password=c.l2tp_passwd.value;parent.l2tp_server_ipaddr=c.l2tp_serv_ip.value;parent.welcome_wan_type=5;if(parent.isp_type=="16"){c.basic_type.value="0";c.ppp_login_type.value="2";c.welcome_wan_type.value="5";c.l2tp_dnsaddr1.value=parent.static_dns1;c.l2tp_dnsaddr2.value=parent.static_dns2;if(c.l2tp_dnsaddr1.value!=""||c.l2tp_dnsaddr2.value!=""){c.DNSAssign.value="1"}else{c.DNSAssign.value="0"}c.WANAssign.value="0";c.STATIC_DNS.value="0";c.submit()}else{if(parent.isp_type=="15"){location.href="RU_isp_spoof.htm"}else{if(parent.isp_type=="13"||parent.isp_type=="14"){location.href="RU_isp_l2tp_static.htm"}else{location.href="RU_manu_local_resources.htm"}}}}function setIP(b){var a=b.DualAssign[0].checked;setDisabled(a,b.myip_1,b.myip_2,b.myip_3,b.myip_4,b.mymask_1,b.mymask_2,b.mymask_3,b.mymask_4,b.mygw_1,b.mygw_2,b.mygw_3,b.mygw_4);DisableFixedIP=a;if(!document.getElementsByTagName("span")[0]){return false}if(b.DualAssign[1].checked){if(b.myip_1.value.length>0||b.myip_2.value.length>0||b.myip_3.value.length>0||b.myip_4.value.length>0){setDisabled(false,b.mymask_1,b.mymask_2,b.mymask_3,b.mymask_4);setDisabled(false,b.mygw_1,b.mygw_2,b.mygw_3,b.mygw_4)}else{setDisabled(true,b.mymask_1,b.mymask_2,b.mymask_3,b.mymask_4);setDisabled(true,b.mygw_1,b.mygw_2,b.mygw_3,b.mygw_4)}b.DNSAssign[1].checked=true;setDNS(b);b.DNSAssign[0].disabled=true;document.getElementsByTagName("span")[0].style.color="gray"}else{document.getElementsByTagName("span")[0].style.color="black";b.DNSAssign[0].disabled=false}}function RU_l2tp_servip_FQDN(a){var b=document.forms[0];servName=b.l2tp_serv_ip.value;if((servName.search(/[A-Za-z]/i)!=-1)){parent.l2tp_server_FQDN=1}else{parent.l2tp_server_FQDN=0}}function RU_l2tp_servip_update(a){var b=document.forms[0];if((parent.l2tp_server_FQDN==1)&&((b.myip_1.value.length>0)||(b.myip_2.value.length>0)||(b.myip_3.value.length>0)||(b.myip_4.value.length>0))){if(b.DNSAssign[0].checked==true){b.DAddr1.disabled=false;b.DAddr2.disabled=false;b.DAddr3.disabled=false;b.DAddr4.disabled=false;b.PDAddr1.disabled=false;b.PDAddr2.disabled=false;b.PDAddr3.disabled=false;b.PDAddr4.disabled=false}b.DNSAssign[0].checked=false;b.DNSAssign[1].checked=true;b.DNSAssign[0].disabled=true;b.STATIC_DNS.value=1}else{b.DNSAssign[0].disabled=false;b.STATIC_DNS.value=0}}function RU_check_l2tp_dual(){var a=document.forms[0];var b=false;a.l2tp_myip.value=a.myip_1.value+"."+a.myip_2.value+"."+a.myip_3.value+"."+a.myip_4.value;a.l2tp_mynetmask.value=a.mymask_1.value+"."+a.mymask_2.value+"."+a.mymask_3.value+"."+a.mymask_4.value;a.l2tp_gateway.value=a.mygw_1.value+"."+a.mygw_2.value+"."+a.mygw_3.value+"."+a.mygw_4.value;if(a.DualAssign[1].checked==true){b=true;parent.l2tp_wan_assign=1;if(checkipaddr(a.l2tp_myip.value)==false){alert(invalid_myip);return false}if(isSameSubNet(a.l2tp_myip.value,lan_subnet,lan_ip,lan_subnet)==true){a.conflict_wanlan.value=1}if(isSameIp(a.l2tp_myip.value,lan_ip)==true){a.conflict_wanlan.value=1}if(isSameSubNet(a.l2tp_myip.value,a.l2tp_mynetmask.value,lan_ip,a.l2tp_mynetmask.value)==true){a.conflict_wanlan.value=1}if(isSameSubNet(a.l2tp_myip.value,a.l2tp_mynetmask.value,lan_ip,lan_subnet)==true){a.conflict_wanlan.value=1}if(checksubnet(a.l2tp_mynetmask.value)==false){alert(invalid_mask);return false}if(a.l2tp_gateway.value!="..."&&(checkgateway(a.l2tp_gateway.value)==false||is_sub_or_broad(a.l2tp_gateway.value,a.l2tp_gateway.value,a.l2tp_mynetmask.value)==false)){alert(invalid_gateway);return false}if(a.l2tp_gateway.value!="..."){if(isSameIp(a.l2tp_myip.value,a.l2tp_gateway.value)==true){alert(invalid_gateway);return false}}else{a.l2tp_gateway.value=""}}else{a.l2tp_myip.value="";a.l2tp_mynetmask.value="";a.l2tp_gateway.value="";parent.l2tp_wan_assign=0}if(a.DNSAssign[1].checked==true){a.l2tp_dnsaddr1.value=a.DAddr1.value+"."+a.DAddr2.value+"."+a.DAddr3.value+"."+a.DAddr4.value;a.l2tp_dnsaddr2.value=a.PDAddr1.value+"."+a.PDAddr2.value+"."+a.PDAddr3.value+"."+a.PDAddr4.value;if(a.l2tp_dnsaddr1.value=="..."){a.l2tp_dnsaddr1.value=""}if(a.l2tp_dnsaddr2.value=="..."){a.l2tp_dnsaddr2.value=""}if(!check_RU_DNS(a.l2tp_dnsaddr1.value,a.l2tp_dnsaddr2.value,b,a.l2tp_myip.value)){return false}}else{a.l2tp_dnsaddr1.value="";a.l2tp_dnsaddr2.value=""}if(a.DualAssign[1].checked==true){alert(attention_static_ip)}parent.l2tp_local_ipaddr=a.l2tp_myip.value;parent.l2tp_local_netmask=a.l2tp_mynetmask.value;parent.l2tp_local_gateway=a.l2tp_gateway.value;parent.l2tp_dns1=a.l2tp_dnsaddr1.value;parent.l2tp_dns2=a.l2tp_dnsaddr2.value;parent.STATIC_DNS=a.STATIC_DNS.value;parent.conflict_wanlan=a.conflict_wanlan.value;location.href="RU_manual_spoof.htm"};