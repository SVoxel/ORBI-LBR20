function check_ipv6_fixed(cf){var i;var ip_trans_array=new Array("","","","","");cf.ipv6_wan_ip_fixed.value="";cf.ipv6_wan_gw_fixed.value="";cf.ipv6_primary_dns_fixed.value="";cf.ipv6_second_dns_fixed.value="";cf.ipv6_lan_ip_fixed.value="";var check_pri_dns=1;var check_sec_dns=1;var check_gate_way=1;var pri_dns="";var sec_dns="";var gate_way="";for(i=1;i<=8;i++){pri_dns=pri_dns+eval('document.getElementsByName("PDAddr'+i+'")[0]').value;sec_dns=sec_dns+eval('document.getElementsByName("SDAddr'+i+'")[0]').value;gate_way=gate_way+eval('document.getElementsByName("IPv6Gateway'+i+'")[0]').value}if(pri_dns==""){check_pri_dns=0}if(sec_dns==""){check_sec_dns=0}if(gate_way==""){check_gate_way=0}for(i=1;i<=8;i++){var ipv6_wan_value=eval('document.getElementsByName("IPv6WanAddr'+i+'")[0]').value;if(check_ipv6_IP_address(ipv6_wan_value)==false){alert("$invalid_wan_ipv6_hex");return false}if(ipv6_wan_value!=""){ipv6_wan_value=parseInt(ipv6_wan_value,16).toString(16)}if(ipv6_wan_value==""){ip_trans_array[0]=ip_trans_array[0]+"0:";cf.ipv6_wan_ip_fixed.value=cf.ipv6_wan_ip_fixed.value+"0:"}else{ip_trans_array[0]=ip_trans_array[0]+ipv6_wan_value+":";cf.ipv6_wan_ip_fixed.value=cf.ipv6_wan_ip_fixed.value+ipv6_wan_value+":"}if(check_gate_way){var ipv6_gateway_value=eval('document.getElementsByName("IPv6Gateway'+i+'")[0]').value;if(check_ipv6_IP_address(ipv6_gateway_value)==false){alert("$invalid_wan_ipv6_gateway");return false}if(ipv6_gateway_value!=""){ipv6_gateway_value=parseInt(ipv6_gateway_value,16).toString(16)}if(ipv6_gateway_value==""){ip_trans_array[1]=ip_trans_array[1]+"0:";cf.ipv6_wan_gw_fixed.value=cf.ipv6_wan_gw_fixed.value+"0:"}else{ip_trans_array[1]=ip_trans_array[1]+ipv6_gateway_value+":";cf.ipv6_wan_gw_fixed.value=cf.ipv6_wan_gw_fixed.value+ipv6_gateway_value+":"}}if(check_pri_dns){var ipv6_pdaddr_value=eval('document.getElementsByName("PDAddr'+i+'")[0]').value;if(check_ipv6_DNS_address(ipv6_pdaddr_value)==false){alert("$invalid_ipv6_primary_dns_hex");return false}if(ipv6_pdaddr_value!=""){ipv6_pdaddr_value=parseInt(ipv6_pdaddr_value,16).toString(16)}if(ipv6_pdaddr_value==""){ip_trans_array[2]=ip_trans_array[2]+"0:";cf.ipv6_primary_dns_fixed.value=cf.ipv6_primary_dns_fixed.value+"0:"}else{ip_trans_array[2]=ip_trans_array[2]+ipv6_pdaddr_value+":";cf.ipv6_primary_dns_fixed.value=cf.ipv6_primary_dns_fixed.value+ipv6_pdaddr_value+":"}}if(check_sec_dns){var ipv6_sdaddr_value=eval('document.getElementsByName("SDAddr'+i+'")[0]').value;if(check_ipv6_DNS_address(ipv6_sdaddr_value)==false){alert("$invalid_ipv6_second_dns_hex");return false}if(ipv6_sdaddr_value!=""){ipv6_sdaddr_value=parseInt(ipv6_sdaddr_value,16).toString(16)}if(ipv6_sdaddr_value==""){ip_trans_array[3]=ip_trans_array[3]+"0:";cf.ipv6_second_dns_fixed.value=cf.ipv6_second_dns_fixed.value+"0:"}else{ip_trans_array[3]=ip_trans_array[3]+ipv6_sdaddr_value+":";cf.ipv6_second_dns_fixed.value=cf.ipv6_second_dns_fixed.value+ipv6_sdaddr_value+":"}}if(check_ipv6_IP_address(cf.IPv6_lan[i-1].value)==false){alert("$invalid_lan_ipv6_hex");return false}if(cf.IPv6_lan[i-1].value!=""){cf.IPv6_lan[i-1].value=parseInt(cf.IPv6_lan[i-1].value,16).toString(16)}if(cf.IPv6_lan[i-1].value==""){ip_trans_array[4]=ip_trans_array[4]+"0:";cf.ipv6_lan_ip_fixed.value=cf.ipv6_lan_ip_fixed.value+"0:"}else{ip_trans_array[4]=ip_trans_array[4]+cf.IPv6_lan[i-1].value+":";cf.ipv6_lan_ip_fixed.value=cf.ipv6_lan_ip_fixed.value+cf.IPv6_lan[i-1].value+":"}}if(check_ipv6_IP_address(cf.ProfixWanLength.value)==false){alert("$invalid_wan_ipv6_addr_pre_length");return false}if(check_ipv6_IP_address(cf.IPv6_lan_prefix.value)==false){alert("$invalid_lan_ipv6_addr_pre_length");return false}var str=cf.ipv6_wan_ip_fixed.value;cf.ipv6_wan_ip_fixed.value=str.substring(0,str.length-1);if(cf.ipv6_wan_ip_fixed.value==":::::::"){cf.ipv6_wan_ip_fixed.value=""}else{if(cf.ipv6_wan_ip_fixed.value=="0:0:0:0:0:0:0:0"){alert("$invalid_wan_ipv6_addr");return false}else{if(ip_trans_array[0]=="0:0:0:0:0:0:0:0:"){alert("$invalid_wan_ipv6_addr");return false}}}cf.ipv6_wan_fixed_prefix.value=cf.ProfixWanLength.value;if(cf.ipv6_wan_ip_fixed.value==""){alert("$wan_lack_ipv6_pre_length");return false}if(cf.ipv6_wan_fixed_prefix.value==""||parseInt(cf.ipv6_wan_fixed_prefix.value,10)>126||parseInt(cf.ipv6_wan_fixed_prefix.value,10)<4){alert("$invalid_wan_ipv6_addr_pre_length");return false}if(check_addr_legality(cf.ipv6_wan_ip_fixed.value)==false){alert("$invalid_wan_ipv6_addr");return false}str=cf.ipv6_wan_gw_fixed.value;cf.ipv6_wan_gw_fixed.value=str.substring(0,str.length-1);if(cf.ipv6_wan_gw_fixed.value==":::::::"){cf.ipv6_wan_gw_fixed.value=""}else{if(cf.ipv6_wan_gw_fixed.value=="0:0:0:0:0:0:0:0"){alert("$invalid_ipv6_gateway");return false}else{if(ip_trans_array[1]=="0:0:0:0:0:0:0:0:"){alert("$invalid_ipv6_gateway");return false}}}if(cf.ipv6_wan_gw_fixed.value!=""){if(check_addr_legality(cf.ipv6_wan_gw_fixed.value)==false){alert("$invalid_ipv6_gateway");return false}}str=cf.ipv6_primary_dns_fixed.value;cf.ipv6_primary_dns_fixed.value=str.substring(0,str.length-1);if(cf.ipv6_primary_dns_fixed.value==":::::::"){cf.ipv6_primary_dns_fixed.value=""}else{if(cf.ipv6_primary_dns_fixed.value=="0:0:0:0:0:0:0:0"){alert("$invalid_ipv6_primary_dns");return false}else{if(ip_trans_array[2]=="0:0:0:0:0:0:0:0:"){alert("$invalid_ipv6_primary_dns");return false}}}if(cf.ipv6_primary_dns_fixed.value!=""){if(check_addr_legality(cf.ipv6_primary_dns_fixed.value)==false){alert("$invalid_ipv6_primary_dns");return false}else{if(cf.ipv6_primary_dns_fixed.value==cf.ipv6_wan_ip_fixed.value){alert("$invalid_wan_primary_second_dns");return false}}}str=cf.ipv6_second_dns_fixed.value;cf.ipv6_second_dns_fixed.value=str.substring(0,str.length-1);if(cf.ipv6_second_dns_fixed.value==":::::::"){cf.ipv6_second_dns_fixed.value=""}else{if(cf.ipv6_second_dns_fixed.value=="0:0:0:0:0:0:0:0"){alert("$invalid_ipv6_second_dns");return false}else{if(ip_trans_array[3]=="0:0:0:0:0:0:0:0:"){alert("$invalid_ipv6_second_dns");return false}}}if(cf.ipv6_second_dns_fixed.value!=""){if(check_addr_legality(cf.ipv6_second_dns_fixed.value)==false){alert("$invalid_ipv6_second_dns");return false}else{if(cf.ipv6_second_dns_fixed.value==cf.ipv6_wan_ip_fixed.value){alert("$invalid_wan_primary_second_dns");return false}else{if(cf.ipv6_primary_dns_fixed.value==cf.ipv6_second_dns_fixed.value){alert("$invalid_primary_second_dns");return false}}}}if(cf.IpAssign[0].checked==true){cf.ipv6_hidden_ip_assign.value="1"}else{cf.ipv6_hidden_ip_assign.value="0"}str=cf.ipv6_lan_ip_fixed.value;cf.ipv6_lan_ip_fixed.value=str.substring(0,str.length-1);if(cf.ipv6_lan_ip_fixed.value==":::::::"){cf.ipv6_lan_ip_fixed.value=""}else{if(cf.ipv6_lan_ip_fixed.value=="0:0:0:0:0:0:0:0"){alert("$invalid_lan_ipv6_addr");return false}else{if(ip_trans_array[4]=="0:0:0:0:0:0:0:0:"){alert("$invalid_lan_ipv6_addr");return false}}}cf.ipv6_lan_fixed_prefix.value=cf.IPv6_lan_prefix.value;if(cf.ipv6_lan_ip_fixed.value==""){alert("$lan_lack_ipv6_pre_length");return false}if(cf.IPv6_lan_prefix.value==""||parseInt(cf.IPv6_lan_prefix.value,10)>126||parseInt(cf.IPv6_lan_prefix.value,10)<4){alert("$invalid_lan_ipv6_addr_pre_length");return false}if(check_addr_legality(cf.ipv6_lan_ip_fixed.value)==false){alert("$invalid_lan_ipv6_addr");return false}var wan_ip=ip_trans_array[0];var gate_way=ip_trans_array[1];var primary_dns=ip_trans_array[2];var second_dns=ip_trans_array[3];var lan_ip=ip_trans_array[4];if(wan_ip!=""&&(wan_ip.toUpperCase()==lan_ip.toUpperCase())){alert("$same_ipv6_lan_wan_ip");return false}if(wan_ip!=""&&(wan_ip==primary_dns||wan_ip==second_dns)){alert("$invalid_wan_ipv6");return false}if(lan_ip!=""&&(lan_ip==primary_dns||lan_ip==second_dns)){alert("$invalid_lan_ipv6");return false}if(cf.IPv6Filtering[0].checked==true){cf.ipv6_hidden_filtering.value="0"}else{if(cf.IPv6Filtering[1].checked==true){cf.ipv6_hidden_filtering.value="1"}}if(have_mapt&&cf.cb_enable.checked==true&&check_mapt(cf)==false){return false}return true}function check_addr_legality(a){if(a.charAt(0).toLowerCase()=="f"&&a.charAt(1).toLowerCase()=="f"){return false}if(a==":::::::1"||a=="0:0:0:0:0:0:0:1"){return false}return true};